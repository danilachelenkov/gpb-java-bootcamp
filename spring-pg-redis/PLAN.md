# üéì P2P Payment System


## üìö –û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫—É—Ä—Å–µ

### üéØ –¶–µ–ª—å
–°–æ–∑–¥–∞—Ç—å —Å –Ω—É–ª—è –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—É—é —Å–∏—Å—Ç–µ–º—É P2P-–ø–ª–∞—Ç–µ–∂–µ–π —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ —Å—Ç–µ–∫–∞ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π.

### üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏
- Java 21
- Spring Boot 3.2
- PostgreSQL 15
- Redis 7 ‚Äî –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ, distributed locks
- Docker & Docker Compose
- Gradle
- MapStruct
- Liquibase

### üìñ –§–æ—Ä–º–∞—Ç
–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞–Ω–∏—è —Å –ø–æ—à–∞–≥–æ–≤—ã–º–∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏ ‚Äî –æ—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞ –¥–æ –¥–µ–ø–ª–æ—è –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.

### üèÅ –†–µ–∑—É–ª—å—Ç–∞—Ç
‚úÖ –†–∞–±–æ—Ç–∞—é—â–µ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ  
‚úÖ –ß–∏—Å—Ç—ã–π, –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π GitHub-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π ‚Äî –≥–æ—Ç–æ–≤ –∫ –¥–æ–±–∞–≤–ª–µ–Ω–∏—é –≤ –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ
----

## üó∫Ô∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫—É—Ä—Å–∞ (10 –º–æ–¥—É–ª–µ–π)

## üì¶ –ú–æ–¥—É–ª—å 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞

### –ß—Ç–æ –±—É–¥–µ–º –∏–∑—É—á–∞—Ç—å:
- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ Docker Desktop
- –ó–∞–ø—É—Å–∫ PostgreSQL –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ —á–µ—Ä–µ–∑ Docker Compose
- –ó–∞–ø—É—Å–∫ Redis –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –∏ –ø–æ–Ω–∏–º–∞–Ω–∏–µ –µ–≥–æ —Ä–æ–ª–∏
- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Redis Insight –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö
- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ PostgreSQL —á–µ—Ä–µ–∑ DBeaver/DataGrip
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ Redis —á–µ—Ä–µ–∑ CLI –∏ Insight
- –°–æ–∑–¥–∞–Ω–∏–µ GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞
- –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–∞—Ç–∞–ª–æ–≥–æ–≤ –ø—Ä–æ–µ–∫—Ç–∞
- –ë–∞–∑–æ–≤–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ `.gitignore` –¥–ª—è Java –ø—Ä–æ–µ–∫—Ç–æ–≤
- –ü–æ–Ω–∏–º–∞–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã: PostgreSQL (–ø–æ—Å—Ç–æ—è–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ) + Redis (–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ)

### –†–µ–∑—É–ª—å—Ç–∞—Ç –º–æ–¥—É–ª—è:
‚úÖ –†–∞–±–æ—Ç–∞—é—â–∞—è –ª–æ–∫–∞–ª—å–Ω–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (PostgreSQL + Redis)  
‚úÖ GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å–æ–∑–¥–∞–Ω  
‚úÖ Docker Compose –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≥–æ—Ç–æ–≤–∞
----

## üèóÔ∏è –ú–æ–¥—É–ª—å 2: Spring Boot –ø—Ä–æ–µ–∫—Ç ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

### –ß—Ç–æ –±—É–¥–µ–º –∏–∑—É—á–∞—Ç—å:
- –°–æ–∑–¥–∞–Ω–∏–µ Spring Boot –ø—Ä–æ–µ–∫—Ç–∞ —á–µ—Ä–µ–∑ Spring Initializr
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Gradle (dependencies, versions)
- –°—Ç—Ä—É–∫—Ç—É—Ä–∞ Maven/Gradle –ø—Ä–æ–µ–∫—Ç–∞ (–æ–±—ä—è—Å–Ω–µ–Ω–∏–µ –ø–∞–ø–æ–∫)
- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è `application.yml` (profiles: dev, prod)
- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ PostgreSQL (DataSource configuration)
- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Redis (RedisTemplate, Lettuce)
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Liquibase –¥–ª—è –º–∏–≥—Ä–∞—Ü–∏–π –ë–î
- –°–æ–∑–¥–∞–Ω–∏–µ –ø–µ—Ä–≤–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏ (—Ç–∞–±–ª–∏—Ü–∞ `users`)
- Health checks (Actuator endpoints)
- –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π

### –†–µ–∑—É–ª—å—Ç–∞—Ç –º–æ–¥—É–ª—è:
‚úÖ Spring Boot –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è  
‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ PostgreSQL –∏ Redis —Ä–∞–±–æ—Ç–∞—é—Ç  
‚úÖ Liquibase –ø—Ä–∏–º–µ–Ω—è–µ—Ç –º–∏–≥—Ä–∞—Ü–∏–∏  
‚úÖ Actuator –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç health status

## üóÑÔ∏è –ú–æ–¥—É–ª—å 3: Database Schema ‚Äî –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ë–î

### –ß—Ç–æ –±—É–¥–µ–º –∏–∑—É—á–∞—Ç—å:
- –ü—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ö–µ–º—ã –ë–î –¥–ª—è P2P —Å–∏—Å—Ç–µ–º—ã
- –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü —á–µ—Ä–µ–∑ Liquibase:
  - `users` (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏)
  - `wallets` (–∫–æ—à–µ–ª—å–∫–∏)
  - `transactions` (–∏—Å—Ç–æ—Ä–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π)
  - `transfer_limits` (–ª–∏–º–∏—Ç—ã)
- –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö (DECIMAL –¥–ª—è –¥–µ–Ω–µ–≥!)
- –ò–Ω–¥–µ–∫—Å—ã –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤
- Foreign keys –∏ constraints
- Enum —Ç–∏–ø—ã (`transaction_type`, `transaction_status`)
- Timestamps (`created_at`, `updated_at`)
- Soft delete (`deleted_at`) vs Hard delete

### –†–µ–∑—É–ª—å—Ç–∞—Ç –º–æ–¥—É–ª—è:
‚úÖ –ü–æ–ª–Ω–∞—è —Å—Ö–µ–º–∞ –ë–î —Å–æ–∑–¥–∞–Ω–∞  
‚úÖ –í—Å–µ —Ç–∞–±–ª–∏—Ü—ã —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ —Ç–∏–ø–∞–º–∏ –∏ constraints  
‚úÖ –ò–Ω–¥–µ–∫—Å—ã –¥–ª—è –±—ã—Å—Ç—Ä—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

## üõ†Ô∏è –ú–æ–¥—É–ª—å 4: Repository —Å–ª–æ–π ‚Äî —Ä–∞–±–æ—Ç–∞ —Å –¥–∞–Ω–Ω—ã–º–∏

### –ß—Ç–æ –±—É–¥–µ–º –∏–∑—É—á–∞—Ç—å:
- Spring Data JPA ‚Äî –æ—Å–Ω–æ–≤—ã
- –°–æ–∑–¥–∞–Ω–∏–µ Entity –∫–ª–∞—Å—Å–æ–≤:
  - `User`
  - `Wallet`
  - `Transaction`
- –ê–Ω–Ω–æ—Ç–∞—Ü–∏–∏ JPA (`@Entity`, `@Table`, `@Column`, `@Id`)
- –°–≤—è–∑–∏ –º–µ–∂–¥—É —Ç–∞–±–ª–∏—Ü–∞–º–∏ (`@OneToMany`, `@ManyToOne`)
- –°–æ–∑–¥–∞–Ω–∏–µ Repository –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤
- Custom queries (`@Query`)
- Derived query methods (`findByUserId`, `findByStatus`)
- Pagination –∏ Sorting
- Specifications –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö —Ñ–∏–ª—å—Ç—Ä–æ–≤ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ Repository —á–µ—Ä–µ–∑ `@DataJpaTest`

### –†–µ–∑—É–ª—å—Ç–∞—Ç –º–æ–¥—É–ª—è:
‚úÖ Entity –∫–ª–∞—Å—Å—ã —Å–æ–∑–¥–∞–Ω—ã  
‚úÖ Repository —Å–ª–æ–π —Ä–∞–±–æ—Ç–∞–µ—Ç  
‚úÖ –ú–æ–∂–µ–º –¥–µ–ª–∞—Ç—å CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –ë–î  
‚úÖ Unit-—Ç–µ—Å—Ç—ã –¥–ª—è Repository –Ω–∞–ø–∏—Å–∞–Ω—ã

## üé® –ú–æ–¥—É–ª—å 5: DTO –∏ Mappers ‚Äî —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Å–ª–æ–µ–≤

### –ß—Ç–æ –±—É–¥–µ–º –∏–∑—É—á–∞—Ç—å:
- –ó–∞—á–µ–º –Ω—É–∂–Ω—ã DTO (Data Transfer Objects)
- Records –≤ Java (—Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π —Å–ø–æ—Å–æ–± —Å–æ–∑–¥–∞–Ω–∏—è DTO)
- –†–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É Entity –∏ DTO
- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ MapStruct
- –°–æ–∑–¥–∞–Ω–∏–µ Mapper –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤:
  - `WalletMapper`
  - `TransactionMapper`
- Mapping –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏ (`@Mapping`, `@MappingTarget`)
- Custom mapping methods
- Nested mappings (User –≤–Ω—É—Ç—Ä–∏ Wallet)
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ Mappers

### –†–µ–∑—É–ª—å—Ç–∞—Ç –º–æ–¥—É–ª—è:
‚úÖ DTO –∫–ª–∞—Å—Å—ã –¥–ª—è –≤—Å–µ—Ö Entity  
‚úÖ MapStruct –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç  
‚úÖ Mappers –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É—é—Ç Entity ‚Üî DTO

## üíº –ú–æ–¥—É–ª—å 6: Service —Å–ª–æ–π + REST API (–±–∞–∑–æ–≤–∞—è –≤–µ—Ä—Å–∏—è)

### –ß—Ç–æ –±—É–¥–µ–º –∏–∑—É—á–∞—Ç—å:

#### –ß–∞—Å—Ç—å 1: Service —Å–ª–æ–π (WalletService)
- –°–æ–∑–¥–∞–Ω–∏–µ `WalletService` —Å –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–æ–π:
  - `createWallet()` ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ –∫–æ—à–µ–ª—å–∫–∞
  - `getWallet(id)` ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ –ø–æ ID
  - `getBalance(walletId)` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–ª–∞–Ω—Å–∞
  - `getAllWalletsByUserId()` ‚Äî –≤—Å–µ –∫–æ—à–µ–ª—å–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ (`@Transactional`)
- Exception handling (`WalletNotFoundException`)
- –í–∞–ª–∏–¥–∞—Ü–∏—è –±–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–π

#### –ß–∞—Å—Ç—å 2: REST API (WalletController)
- –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ—Å—Ç–æ–≥–æ `WalletController`:
  - `POST /api/wallets` ‚Äî —Å–æ–∑–¥–∞—Ç—å –∫–æ—à–µ–ª–µ–∫
  - `GET /api/wallets/{id}` ‚Äî –ø–æ–ª—É—á–∏—Ç—å –∫–æ—à–µ–ª–µ–∫
  - `GET /api/wallets/user/{userId}` ‚Äî –≤—Å–µ –∫–æ—à–µ–ª—å–∫–∏ —é–∑–µ—Ä–∞
  - `GET /api/wallets/{id}/balance` ‚Äî –±–∞–ª–∞–Ω—Å
- `@RestController`, `@RequestMapping` –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏
- `@RequestBody` –∏ `@PathVariable`
- `ResponseEntity` –∏ HTTP —Å—Ç–∞—Ç—É—Å—ã
- –ë–∞–∑–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ (`@ExceptionHandler`)

#### –ß–∞—Å—Ç—å 3: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- Unit-—Ç–µ—Å—Ç—ã –¥–ª—è `WalletService` (`@SpringBootTest`)
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ Postman:
  - –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ—à–µ–ª—å–∫–∞
  - –ü–æ–ª—É—á–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—à–∏–±–æ–∫ (–Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π ID)
- Debug —Å breakpoints –≤ IDE
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ HTTP –∑–∞–ø—Ä–æ—Å–æ–≤

### –†–µ–∑—É–ª—å—Ç–∞—Ç –º–æ–¥—É–ª—è:
‚úÖ WalletService —Å –±–∞–∑–æ–≤–æ–π –ª–æ–≥–∏–∫–æ–π —Ä–∞–±–æ—Ç–∞–µ—Ç  
‚úÖ REST API –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ HTTP ‚≠ê  
‚úÖ –ú–æ–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —á–µ—Ä–µ–∑ Postman ‚≠ê  
‚úÖ –ú–æ–∂–Ω–æ –¥–µ–ª–∞—Ç—å Debug —á–µ—Ä–µ–∑ IDE ‚≠ê  
‚úÖ Unit-—Ç–µ—Å—Ç—ã –ø–æ–∫—Ä—ã–≤–∞—é—Ç —Å–µ—Ä–≤–∏—Å

## üîÅ –ú–æ–¥—É–ª—å 7: Redis ‚Äî –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ (–¥–æ–±–∞–≤–ª—è–µ–º –≤ —Ä–∞–±–æ—Ç–∞—é—â–∏–π API) 

### –ß—Ç–æ –±—É–¥–µ–º –∏–∑—É—á–∞—Ç—å:

#### –ß–∞—Å—Ç—å 1: –¢–µ–æ—Ä–∏—è
- –ó–∞—á–µ–º –Ω—É–∂–µ–Ω –∫—ç—à –≤ —Ñ–∏–Ω—Ç–µ—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö
- Redis vs in-memory –∫—ç—à (Caffeine)
- Cache-aside pattern
- TTL (Time To Live) —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏

#### –ß–∞—Å—Ç—å 2: –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ Redis –∫—ç—à–∞
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Spring Cache (`@EnableCaching`)
- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è `RedisCacheManager`
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ `@Cacheable` –Ω–∞ `getWallet(id)`:

```java
@Cacheable(value = "wallets", key = "#id")
public WalletResponse getWallet(Long id) { ... }

```
- `@CacheEvict` –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –∏–∑ –∫—ç—à–∞
- `@CachePut` –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫—ç—à–∞
- Custom cache key generation

#### –ß–∞—Å—Ç—å 3: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å Redis
- –ó–∞–ø—É—Å–∫–∞–µ–º Postman:
  - –ü–µ—Ä–≤—ã–π `GET /api/wallets/1` ‚Üí –º–µ–¥–ª–µ–Ω–Ω—ã–π (–∏–∑ PostgreSQL)
  - –í—Ç–æ—Ä–æ–π `GET /api/wallets/1` ‚Üí –±—ã—Å—Ç—Ä—ã–π (–∏–∑ Redis)
- –û—Ç–∫—Ä—ã–≤–∞–µ–º Redis Insight ‚Üí –≤–∏–¥–∏–º –∑–∞–∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ–±—ä–µ–∫—Ç
- Debug: —Å—Ç–∞–≤–∏–º breakpoint –≤ `getWallet()` ‚Üí –≤—Ç–æ—Ä–æ–π –∑–∞–ø—Ä–æ—Å –Ω–µ –ø–æ–ø–∞–¥–∞–µ—Ç –≤ –º–µ—Ç–æ–¥!
- –ò–∑–º–µ—Ä—è–µ–º –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ (–¥–æ/–ø–æ—Å–ª–µ –∫—ç—à–∞)
- –¢–µ—Å—Ç–∏—Ä—É–µ–º –∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—é –∫—ç—à–∞

### –†–µ–∑—É–ª—å—Ç–∞—Ç –º–æ–¥—É–ª—è:
‚úÖ Redis –∫—ç—à —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏  
‚úÖ –í–∏–¥–∏–º —É—Å–∫–æ—Ä–µ–Ω–∏–µ —á–µ—Ä–µ–∑ Postman ‚≠ê  
‚úÖ –í–∏–¥–∏–º –¥–∞–Ω–Ω—ã–µ –≤ Redis Insight ‚≠ê  
‚úÖ –ü–æ–Ω–∏–º–∞–µ–º –∫–æ–≥–¥–∞ –∫—ç—à –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è/–æ—á–∏—â–∞–µ—Ç—Å—è

## üîí –ú–æ–¥—É–ª—å 8: Redis ‚Äî distributed locks –∏ rate limiting ‚≠ê –û–ë–ù–û–í–õ–ï–ù

### –ß—Ç–æ –±—É–¥–µ–º –∏–∑—É—á–∞—Ç—å:

#### –ß–∞—Å—Ç—å 1: TransferService ‚Äî –ª–æ–≥–∏–∫–∞ –ø–µ—Ä–µ–≤–æ–¥–æ–≤
- –°–æ–∑–¥–∞–Ω–∏–µ `TransferService`:
  - `transfer(fromWalletId, toWalletId, amount)` ‚Äî –ø–µ—Ä–µ–≤–æ–¥ –¥–µ–Ω–µ–≥
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–ª–∞–Ω—Å–∞
  - Atomic –æ–ø–µ—Ä–∞—Ü–∏–∏ (–¥–µ–±–µ—Ç + –∫—Ä–µ–¥–∏—Ç)
  - –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏ –≤ `transactions`
- –°–æ–∑–¥–∞–Ω–∏–µ `TransferController`:
  - `POST /api/transfers` ‚Äî –≤—ã–ø–æ–ª–Ω–∏—Ç—å –ø–µ—Ä–µ–≤–æ–¥

#### –ß–∞—Å—Ç—å 2: –ü—Ä–æ–±–ª–µ–º–∞ race condition ‚≠ê –ù–û–í–û–ï
- –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –ø—Ä–æ–±–ª–µ–º—ã —á–µ—Ä–µ–∑ Postman:
  - –û—Ç–∫—Ä—ã–≤–∞–µ–º 2 –≤–∫–ª–∞–¥–∫–∏ Postman
  - –û–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º 2 –ø–µ—Ä–µ–≤–æ–¥–∞ —Å –æ–¥–Ω–æ–≥–æ –∫–æ—à–µ–ª—å–∫–∞
  - –í–∏–¥–∏–º —á—Ç–æ –±–∞–ª–∞–Ω—Å —Å—Ç–∞–ª –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º! (race condition)
  - Debug: —Å–º–æ—Ç—Ä–∏–º —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ –ª–æ–≥–∞—Ö

#### –ß–∞—Å—Ç—å 3: –†–µ—à–µ–Ω–∏–µ —á–µ—Ä–µ–∑ Redisson
- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ Redisson (Redis distributed lock library)
- –°–æ–∑–¥–∞–Ω–∏–µ `@DistributedLock` –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏ (–∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Redisson API)
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –≤ `transfer()`

```java
RLock lock = redisson.getLock("wallet:" + fromWalletId);
lock.lock();
try {
    // –ø–µ—Ä–µ–≤–æ–¥ –¥–µ–Ω–µ–≥
} finally {
    lock.unlock();
}

```

- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å lock ‚Äî —Ç–µ–ø–µ—Ä—å –≤—Ç–æ—Ä–æ–π –∑–∞–ø—Ä–æ—Å –∂–¥–µ—Ç!

#### –ß–∞—Å—Ç—å 4: Rate Limiting
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–µ—Ä–µ–≤–æ–¥–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 10 –≤ –º–∏–Ω—É—Ç—É)
- –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ Redis counter + TTL
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ Postman: –¥–µ–ª–∞–µ–º 15 –∑–∞–ø—Ä–æ—Å–æ–≤ –ø–æ–¥—Ä—è–¥ ‚Üí 11-–π –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 429 Too Many Requests

### –†–µ–∑—É–ª—å—Ç–∞—Ç –º–æ–¥—É–ª—è:
‚úÖ TransferService —Ä–∞–±–æ—Ç–∞–µ—Ç  
‚úÖ –í–∏–¥–∏–º race condition —á–µ—Ä–µ–∑ 2 Postman –∑–∞–ø—Ä–æ—Å–∞ ‚≠ê  
‚úÖ Distributed lock —Ä–µ—à–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—É  
‚úÖ Rate limiting –∑–∞—â–∏—â–∞–µ—Ç –æ—Ç –∑–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–π

## üîê –ú–æ–¥—É–ª—å 9: Security ‚Äî JWT authentication

### –ß—Ç–æ –±—É–¥–µ–º –∏–∑—É—á–∞—Ç—å:
- Spring Security –æ—Å–Ω–æ–≤—ã
- JWT —Ç–æ–∫–µ–Ω—ã ‚Äî –∫–∞–∫ –æ–Ω–∏ —Ä–∞–±–æ—Ç–∞—é—Ç
- –°–æ–∑–¥–∞–Ω–∏–µ `AuthService`:
  - `register()` ‚Äî —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
  - `login()` ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ JWT —Ç–æ–∫–µ–Ω–∞
- JWT token generation (–±–∏–±–ª–∏–æ—Ç–µ–∫–∞ jjwt)
- JWT token validation
- `SecurityFilterChain` –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- Custom `JwtAuthenticationFilter`
- –ó–∞—â–∏—Ç–∞ endpoints (`@PreAuthorize`)
- –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ `SecurityContext`

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ Postman:
- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è ‚Üí –ø–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞
- –ó–∞–ø—Ä–æ—Å –±–µ–∑ —Ç–æ–∫–µ–Ω–∞ ‚Üí 401 Unauthorized
- –ó–∞–ø—Ä–æ—Å —Å —Ç–æ–∫–µ–Ω–æ–º ‚Üí 200 OK

### –†–µ–∑—É–ª—å—Ç–∞—Ç –º–æ–¥—É–ª—è:
‚úÖ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏ –ª–æ–≥–∏–Ω —Ä–∞–±–æ—Ç–∞—é—Ç  
‚úÖ JWT —Ç–æ–∫–µ–Ω—ã –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è  
‚úÖ –í—Å–µ endpoints –∑–∞—â–∏—â–µ–Ω—ã  
‚úÖ –ú–æ–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —á–µ—Ä–µ–∑ Postman —Å Bearer token

## üìä –ú–æ–¥—É–ª—å 10: –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Ñ–∏—á–∏ –∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

### –ß—Ç–æ –±—É–¥–µ–º –∏–∑—É—á–∞—Ç—å:

#### –ß–∞—Å—Ç—å 1: Transaction history
- `GET /api/transactions?page=0&size=20` ‚Äî –∏—Å—Ç–æ—Ä–∏—è –ø–µ—Ä–µ–≤–æ–¥–æ–≤
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –¥–∞—Ç–µ, —Å—Ç–∞—Ç—É—Å—É, —Ç–∏–ø—É
- Pagination —á–µ—Ä–µ–∑ Spring Data

#### –ß–∞—Å—Ç—å 2: Admin endpoints
- `GET /api/admin/users` ‚Äî —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- `PUT /api/admin/users/{id}/block` ‚Äî –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞
- Role-based access control (ADMIN vs USER)

#### –ß–∞—Å—Ç—å 3: Monitoring
- Spring Boot Actuator (metrics, health)
- Custom metrics (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–µ—Ä–µ–≤–æ–¥–æ–≤, —Å—Ä–µ–¥–Ω—è—è —Å—É–º–º–∞)
- Prometheus + Grafana (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

#### –ß–∞—Å—Ç—å 4: –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- Swagger/OpenAPI integration
- –û–ø–∏—Å–∞–Ω–∏–µ –≤—Å–µ—Ö endpoints
- –î–æ—Å—Ç—É–ø–Ω–æ –Ω–∞: `http://localhost:8080/swagger-ui.html`

#### –ß–∞—Å—Ç—å 5: Deployment –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å
- Dockerfile –¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- Docker Compose —Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º + PostgreSQL + Redis
- Environment variables –¥–ª—è production
- Healthcheck endpoints

### –†–µ–∑—É–ª—å—Ç–∞—Ç –º–æ–¥—É–ª—è:
‚úÖ –í—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ —Ñ–∏—á–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã  
‚úÖ Swagger –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞  
‚úÖ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≥–æ—Ç–æ–≤–æ –∫ –¥–µ–ø–ª–æ—é